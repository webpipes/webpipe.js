(function(){var a=this;var b={};var c=function(a){return new d(a)};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=c;a.XMLHttpRequest=require("xmlhttprequest").XMLHttpRequest}exports.webpipe=c}else{a["webpipe"]=c}c.VERSION="0.0.1";c.REGISTRY="http://registry.webpipes.org/";c.DISPATCH="http://dispatch.webpipes.org/";c.manual=function(a,d){var e=c.REGISTRY+"webpipes/"+a;b.ajax({url:e,method:"GET",callback:d})};c.request=function(a,d,e){var f=c.DISPATCH+a;b.ajax({url:f,method:"POST",data:d,callback:e})};b.ajax=function(c){var d;var e="";if(typeof c!="object"){return false}if(!c.hasOwnProperty("url")||!c.hasOwnProperty("method")||!c.hasOwnProperty("callback")){return false}if(typeof c.callback!="function"){return false}if(c.data&&Object.keys(c).length){e=b.makeQueryString(c.data)}if(a.XMLHttpRequest){d=new a.XMLHttpRequest;d.onreadystatechange=function(){if(this.readyState==4){if(this.status==200){c.callback(false,this.responseText)}else{c.callback(true,this.responseText)}}};d.open(c.method,c.url,true);if(c.method==="POST"){d.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}if(e.length){d.send(e)}else{d.send(null)}}else if(a.ActiveXObject){d=new ActiveXObject("Microsoft.XMLHTTP");if(d){d.onreadystatechange=function(){if(this.readyState==4){if(this.status==200){c.callback(false,this.responseText)}else{c.callback(true,this.responseText)}}};d.open(c.method,c.url,true);if(c.method==="POST"){d.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}if(e.length){d.send(e)}else{d.send()}}}else{c.callback("Environment does not support XMLHttpRequest",{})}};b.makeQueryString=function(a){var b="";for(key in a){b+=key+"="+a[key]+"&"}return b.slice(0,b.length-1)};var d=function(a){this._wrapped=a};c.prototype=d.prototype;var webpipe=c;}).call(this)
