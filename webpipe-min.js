(function(){var a=this;var b={};var c=function(a){return new d(a)};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=c;a.XMLHttpRequest=require("xmlhttprequest").XMLHttpRequest}exports.webpipe=c}else{a["webpipe"]=c}c.VERSION="0.1.2";c.REGISTRY="http://registry.webpipes.org/";c.DISPATCH="http://dispatch.webpipes.org/";c.manual=function(a,d){var e=c.REGISTRY+"webpipes/"+a;b.ajax({url:e,method:"GET",callback:d})};c.request=function(a,d,e){var f=c.DISPATCH+a;b.ajax({url:f,method:"POST",data:d,callback:e})};b.ajax=function(d){var e;var f="";if(typeof d!="object"){return false}if(!d.hasOwnProperty("url")||!d.hasOwnProperty("method")||!d.hasOwnProperty("callback")){return false}if(typeof d.callback!="function"){return false}if(d.data&&Object.keys(d.data).length){f=b.makeQueryString(d.data)}if(a.XMLHttpRequest){e=new a.XMLHttpRequest;e.onreadystatechange=function(){if(this.readyState==4){if(this.status==200){d.callback(false,this.responseText)}else{d.callback(true,this.responseText)}}};e.open(d.method,d.url,true);e.setRequestHeader("X-Requested-With","Webpipe.js/"+c.VERSION);if(d.method==="POST"){e.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}if(f.length){e.send(f)}else{e.send(null)}}else if(a.ActiveXObject){e=new ActiveXObject("Microsoft.XMLHTTP");if(e){e.onreadystatechange=function(){if(this.readyState==4){if(this.status==200){d.callback(false,this.responseText)}else{d.callback(true,this.responseText)}}};e.open(d.method,d.url,true);e.setRequestHeader("X-Requested-With","Webpipe.js/"+c.VERSION);if(d.method==="POST"){e.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}if(f.length){e.send(f)}else{e.send()}}}else{d.callback("Environment does not support XMLHttpRequest",{})}};b.makeQueryString=function(a){var b="";for(key in a){b+=key+"="+a[key]+"&"}return b.slice(0,b.length-1)};var d=function(a){this._wrapped=a};c.prototype=d.prototype;var webpipe=c;}).call(this)